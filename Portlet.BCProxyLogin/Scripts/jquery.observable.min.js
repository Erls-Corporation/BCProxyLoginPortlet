/*! jsObservable: http://github.com/BorisMoore/jsviews */
(function(d,f){d.observable=function(i,h){return d.isArray(i)?new e(i):new b(i)};var g=[].splice;function b(h){if(!this.data){return new b(h)}this._data=h;return this}d.observable.Object=b;b.prototype={_data:null,data:function(){return this._data},afterChange:function(h,i){},setProperty:function(p,o){if(d.isArray(p)){for(var n=0,j=p.length;n<j;n++){var q=p[n];this.setProperty(q.name,q.value)}}else{if(typeof(p)==="object"){for(var m in p){this.setProperty(m,p[m])}}else{var k=this._data,h=c(k,p);p=h[1];h=h[0];if(h){this._setProperty(h,p,o)}}}return this},_setProperty:function(h,k,j){var l,i=h[k];if(d.isFunction(i)){l=i;i=i.call(h)}if(i!=j){if(l){l.call(h,j);j=l.call(h)}else{h[k]=j}this._trigger(h,{path:k,value:j,oldValue:i})}},_trigger:function(i,h){d(i).triggerHandler("propertyChange",h)}};function c(h,j){if(h&&j){var i=j.split(".");j=i.pop();while(h&&i.length){h=h[i.shift()]}return[h,j]}return[]}function e(h){if(!this.data){return new e(h)}this._data=h;return this}function a(h){if(typeof h!=="number"){throw"Invalid index."}}d.observable.Array=e;e.prototype={_data:null,data:function(){return this._data},insert:function(h,i){a(h);if(arguments.length>1){i=d.isArray(i)?i:[i];if(i.length>0){this._insert(h,i)}}return this},_insert:function(h,i){g.apply(this._data,[h,0].concat(i));this._trigger({change:"insert",index:h,items:i})},remove:function(i,j){a(i);j=(j===f||j===null)?1:j;if(j&&i>-1){var h=this._data.slice(i,i+j);j=h.length;if(j){this._remove(i,j,h)}}return this},_remove:function(i,j,h){this._data.splice(i,j);this._trigger({change:"remove",index:i,items:h})},move:function(k,j,h){a(k);a(j);h=(h===f||h===null)?1:h;if(h){var i=this._data.slice(k,k+h);this._move(k,j,h,i)}return this},_move:function(k,j,h,i){this._data.splice(k,h);this._data.splice.apply(this._data,[j,0].concat(i));this._trigger({change:"move",oldIndex:k,index:j,items:i})},refresh:function(h){var i=this._data.slice(0);this._refresh(i,h);return this},_refresh:function(i,h){g.apply(this._data,[0,this._data.length].concat(h));this._trigger({change:"refresh",oldItems:i})},_trigger:function(h){d([this._data]).triggerHandler("arrayChange",h)}}})(jQuery);